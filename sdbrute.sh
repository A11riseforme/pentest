#!/bin/bash
if [ $# != 3 ] ; then
echo "USAGE: $0 ip domain filter_type(size/code)"
echo " e.g.: $0 10.10.10.145 player.htb size"
echo " e.g.: $0 10.10.10.145 player.htb code"
exit 1;
fi

if [ $3 == "code" ]
then
    baseline=$(curl -s -I http://$1/ -H "Host: 7h15d035n073x157.$2" | head -n 1 | cut -d$' ' -f2)
    ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://$1/ -H "Host: FUZZ.$2" -fc $baseline
elif [ $3 == "size" ]
then
    baseline=$(curl -s http://$1/ -H "Host: 7h15d035n073x157.$2" | wc -c)
    ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://$1/ -H "Host: FUZZ.$2" -fs $baseline
else
    echo "Wrong filter_type!"
fi
